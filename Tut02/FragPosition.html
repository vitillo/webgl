<html>
  <head>
    <title>Tut 02 Playing with Colors</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <script src="../framework/framework.js"></script>
    <script type="text/javascript">
      var canvas = null;
      var gl = null;
      var positionBufferObject = null;
      var theProgram = null;
     
      function start() {
        init();
        display();
       }
      
      function init(){
        initializeWebGL();
        initializeProgram();
        initializeVertexBuffer();
      }

      function initializeWebGL() {
        canvas = document.getElementById("glcanvas");
        canvas.width = 500;
        canvas.height = 500;
        
        try {
          gl = canvas.getContext("experimental-webgl");
        }
        catch(e) {
        }
        
        if (!gl) {
          alert("Unable to initialize WebGL. Your browser may not support it.");
        }
      }

      function initializeProgram(){
        var shaderList = [];

        shaderList.push(loadShader(gl, "shader-fs"));
        shaderList.push(loadShader(gl, "shader-vs"));

        theProgram = createProgram(shaderList);
      }

      function initializeVertexBuffer(){
        var vertexPositions = [
          0.75, 0.75, 0.0, 1.0,
          0.75, -0.75, 0.0, 1.0,
          -0.75, -0.75, 0.0, 1.0];

        positionBufferObject = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, positionBufferObject);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexPositions), gl.STATIC_DRAW);
        gl.bindBuffer(gl.ARRAY_BUFFER, null);
      }

      function display(){
        var vertexPositionAttribute = null;

        gl.clearColor(0.0, 0.0, 0.0, 0.0);
        gl.clear(gl.COLOR_BUFFER_BIT);

        gl.useProgram(theProgram);

        gl.bindBuffer(gl.ARRAY_BUFFER, positionBufferObject);
        vertexPositionAttribute = gl.getAttribLocation(theProgram, "aVertexPosition");
        gl.enableVertexAttribArray(vertexPositionAttribute);
        gl.vertexAttribPointer(vertexPositionAttribute, 4, gl.FLOAT, false, 0, 0);

        gl.drawArrays(gl.TRIANGLES, 0, 3);

        gl.disableVertexAttribArray(vertexPositionAttribute);
        gl.useProgram(null);
      }

    </script>
  </head>

  <style type="text/css">
    canvas {
      width: 500px;
      height: 500px;
      background-color: black;
    }
  </style>

  <script id="shader-fs" type="x-shader/x-fragment">
    void main(void) {
      precision mediump float;
      float lerpValue = gl_FragCoord.y / 500.0;
      gl_FragColor = mix(vec4(1.0, 1.0, 1.0, 1.0), vec4(0.2, 0.2, 0.2, 1.0), lerpValue);
    }
  </script>

  <script id="shader-vs" type="x-shader/x-vertex">
    attribute vec4 aVertexPosition;

    void main(void) {
      gl_Position = aVertexPosition;
    }
  </script>
	
  <body onload="start()">
    <canvas id="glcanvas">
      Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
    </canvas>
  </body>
</html>
